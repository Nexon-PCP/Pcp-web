<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Apresenta√ß√£o - PCP</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='sistema.css') }}?v=61">
    <script src="{{ url_for('static', filename='colorir-status.js') }}?v=61"></script>
    <style>
        body {
            margin: 0;
            padding: 0;
            overflow: hidden;
        }
        
        .apresentacao-container {
            width: 100%;
            height: 100vh;
            display: flex;
            flex-direction: column;
            background: var(--sap-bg);
        }
        
        .apresentacao-header {
            background: #0a1f3d;
            border-bottom: 2px solid #1a3f5d;
            padding: 30px 20px;
            text-align: center;
            min-height: 150px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .apresentacao-header h1 {
            font-size: 60px;
            margin: 0;
            color: #ffffff !important;
            font-weight: bold;
            font-family: 'Helvetica', 'Arial', sans-serif;
            letter-spacing: 1px;
        }
        
        .apresentacao-content {
            flex: 1;
            overflow-y: auto;
            padding: 0;
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
        }
        
        .apresentacao-footer {
            background: #333;
            color: white;
            padding: 15px 20px;
            text-align: center;
            font-size: 16px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .card {
            margin-bottom: 20px;
            padding: 0;
        }
        
        .kpi {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            min-height: 200px;
        }
        
        .kpi .box {
            padding: 20px;
            text-align: center;
            background: #0a1f3d !important;
            border: 2px solid #1a3f5d !important;
            border-radius: 4px !important;
        }
        
        .kpi .box > div:first-child {
            color: #ffffff !important;
            font-size: 30px !important;
            margin-bottom: 10px;
            font-weight: bold;
        }
        
        .kpi .n {
            display: block;
            margin-top: 10px;
            color: #ffd700 !important;
            font-size: 60px !important;
            font-weight: bold !important;
        }
        
        .badge {
            display: inline-block;
            padding: 8px 16px;
            border-radius: 4px;
            font-weight: bold;
            font-size: 30px;
            margin-right: 10px;
            margin-bottom: 8px;
        }
        
        .badge-dashboard {
            font-size: 40px !important;
        }
        
        .status-row {
            display: flex;
            gap: 10px;
            margin-bottom: 10px;
            flex-wrap: wrap;
        }
        
        h3 {
            margin-top: 0;
            margin-bottom: 15px;
        }
        
        /* Dashboard h3 - estilo aeroporto (azul escuro com texto branco) */
        .apresentacao-container h3 {
            display: block !important;
            background: #0a1f3d !important;
            color: #ffffff !important;
            padding: 8px 20px !important;
            border-radius: 0 !important;
            font-weight: bold !important;
            font-size: 18px !important;
            font-family: Helvetica, Arial, sans-serif !important;
            letter-spacing: 0.5px !important;
            text-transform: uppercase !important;
            margin-top: 0 !important;
            margin-bottom: 0 !important;
            width: 100% !important;
        }
        
        /* Dashboard .card - fundo azul escuro */
        #tela-dashboard .card {
            background: #0a1f3d !important;
            border: 1px solid #1a3f5d !important;
        }
        
        /* Produtos em Dashboard - fundo azul com letra amarela */
        #tela-dashboard .card:last-child > div > div {
            background: #0a1f3d !important;
            color: #ffd700 !important;
            border: 2px solid #1a3f5d !important;
            font-size: 40px !important;
            font-weight: bold !important;
            text-align: center !important;
            padding: 14px !important;
            border-radius: 12px !important;
            box-shadow: 0 4px 8px rgba(0,0,0,0.3) !important;
        }
        
        /* Dashboard .status-row - fundo azul */
        #tela-dashboard .status-row {
            background: #0a1f3d !important;
            padding: 15px !important;
            border-radius: 4px !important;
        }
        
        /* h3 APENAS para as tabelas (tela-obras, tela-ops, tela-tarefas) - com fundo azul escuro */
        #tela-obras .card h3,
        #tela-ops .card h3,
        #tela-tarefas .card h3 {
            background: #0a1f3d !important;
            color: #ffffff !important;
            padding: 15px 20px !important;
            border-radius: 4px !important;
            font-size: 24px !important;
            font-weight: bold !important;
            font-family: Helvetica, Arial, sans-serif !important;
            letter-spacing: 0.5px !important;
            text-transform: uppercase !important;
        }
        
        /* Reduzir altura APENAS na tela de apresentacao */
        #tela-dashboard .card h3 {
            padding: 8px 20px !important;
        }
        
        .contador {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(0,0,0,0.7);
            color: white;
            padding: 10px 20px;
            border-radius: 5px;
            font-size: 16px;
            font-weight: bold;
            z-index: 1000;
        }
        
        table {
            width: 100%;
            font-size: 20px;
            border-collapse: collapse;
        }
        
        table thead {
            background: linear-gradient(180deg,#cfe0ff,#a9c4f3);
            position: sticky;
            top: 0;
        }
        
        table {
            background-color: #0a1f3d;
        }
        
        table th {
            padding: 18px 14px;
            text-align: left;
            font-size: 25px;
            font-weight: bold;
            font-family: 'Helvetica', 'Arial', sans-serif;
            letter-spacing: 0.5px;
            border-bottom: 2px solid #1a3f5d;
            border-right: 1px solid #1a3f5d;
            height: 60px;
            color: #ffffff !important;
            background-color: #0a2847 !important;
            text-transform: uppercase;
            vertical-align: middle;
        }
        
        #tela-obras table th,
        #tela-ops table th,
        #tela-tarefas table th {
            height: 60px;
        }
        
        table th[style*="background"] {
            background-color: #0a2847 !important;
            color: #ffffff !important;
        }
        
        thead th {
            background-color: #0a2847 !important;
            color: #ffffff !important;
        }
        
        thead tr {
            background-color: #0a2847 !important;
        }
        
        thead tr th {
            background-color: #0a2847 !important;
            color: #ffffff !important;
        }
        
        thead tr:nth-child(2) th {
            background-color: #0a2847 !important;
            color: #ffffff !important;
        }
        
        thead tr:last-child th {
            background-color: #0a2847 !important;
            color: #ffffff !important;
        }
        
        .card table thead th {
            background-color: #0a2847 !important;
            color: #ffffff !important;
            border-color: #1a3f5d !important;
        }
        
        .card table thead tr th {
            background-color: #0a2847 !important;
            color: #ffffff !important;
        }
        
        #tela-obras table thead th,
        #tela-ops table thead th,
        #tela-tarefas table thead th {
            background-color: #0a2847 !important;
            color: #ffffff !important;
        }
        
        table td {
            padding: 16px 14px;
            font-size: 35px !important;
            font-weight: bold !important;
            font-family: 'Helvetica', 'Arial', sans-serif;
            letter-spacing: 0.3px;
            border-bottom: 1px solid #1a3f5d;
            border-right: 1px solid #1a3f5d;
            height: 50px;
            vertical-align: middle;
            color: #ffffff !important;
            background-color: #0a1f3d;
        }
        
        /* Altura das linhas em apresenta√ß√£o */
        .apresentacao-container #tela-obras table td {
            height: 60px !important;
        }
        
        .apresentacao-container #tela-ops table td {
            height: 65px !important;
        }
        
        #tela-obras table td,
        #tela-ops table td {
            height: 60px;
        }
        
        table tbody tr {
            background-color: #0a1f3d !important;
        }
        
        table tbody tr:nth-child(even) {
            background-color: #0a1f3d !important;
        }
        
        table tbody tr:hover {
            background-color: #1a3f5d !important;
        }
        
        table td[style*="background: #fff3cd"],
        table td[style*="background: #ecf8fb"] {
            color: #ffffff !important;
            font-size: 25px !important;
            font-weight: bold !important;
            background-color: #0a1f3d !important;
        }
        
        #tela-obras table td:nth-child(6),
        #tela-obras table td:nth-child(7),
        #tela-obras table td:nth-child(8),
        #tela-obras table td:nth-child(9),
        #tela-ops table td:nth-child(9),
        #tela-ops table td:nth-child(10),
        #tela-ops table td:nth-child(11),
        #tela-ops table td:nth-child(12),
        #tela-tarefas table td:nth-child(5),
        #tela-tarefas table td:nth-child(6),
        #tela-tarefas table td:nth-child(7),
        #tela-tarefas table td:nth-child(8) {
            background-color: #0a1f3d !important;
            color: #ffffff !important;
        }
        
        #tela-obras table td:nth-child(6),
        #tela-obras table td:nth-child(7),
        #tela-obras table td:nth-child(8),
        #tela-obras table td:nth-child(9),
        #tela-ops table td:nth-child(9),
        #tela-ops table td:nth-child(10),
        #tela-ops table td:nth-child(11),
        #tela-ops table td:nth-child(12),
        #tela-tarefas table td:nth-child(5),
        #tela-tarefas table td:nth-child(6),
        #tela-tarefas table td:nth-child(7),
        #tela-tarefas table td:nth-child(8) {
            font-size: 35px !important;
            font-weight: bold !important;
        }
        

        
        #tela-tarefas table tbody td {
            height: 60px;
        }
        
        /* Altura das linhas de Tarefas em apresenta√ß√£o - sobrescreve */
        .apresentacao-container #tela-tarefas table tbody tr td {
            height: 40px !important;
            min-height: 40px !important;
            max-height: 40px !important;
        }
        
        /* Reduzir fonte da coluna Tarefa para 25px em apresenta√ß√£o */
        .apresentacao-container #tela-tarefas table tbody td:nth-child(1) {
            font-size: 25px !important;
        }
        
        /* Texto amarelo em colunas espec√≠ficas */
        #tela-ops table td:nth-child(4) {
            color: #ffd700 !important;
        }
        
        /* Status em Obras e OPs - font-size 35px */
        #tela-obras table td:nth-child(4),
        #tela-ops table td:nth-child(8) {
            font-size: 35px !important;
        }
        
        #tela-tarefas table td:nth-child(2) {
            color: #ffd700 !important;
        }
        
        #tela-obras table td:nth-child(2) {
            color: #ffd700 !important;
        }
        
        /* Coluna % - Azul com n√∫mero amarelo */
        #tela-obras table td:nth-child(5),
        #tela-ops table td:nth-child(7),
        #tela-tarefas table td:nth-child(4) {
            background-color: #0a1f3d !important;
            color: #ffd700 !important;
            font-size: 35px !important;
            font-weight: bold !important;
        }
        
        /* For√ßar % de OPs amarelo - com m√°xima especificidade */
        #tela-ops table tbody tr td:nth-child(7),
        #tela-ops table body tr td:nth-child(7) {
            color: #ffd700 !important;
            background-color: #0a1f3d !important;
            font-size: 35px !important;
            font-weight: bold !important;
        }
        
        /* Coluna "Data Fim de Montagem" em amarelo - Obras */
        #tela-obras table tbody tr td:nth-child(9) {
            color: #ffd700 !important;
            background-color: #0a1f3d !important;
            font-size: 35px !important;
        }
        
        /* Coluna "Data Fim de Montagem" em amarelo - OPs */
        #tela-ops table tbody tr td:nth-child(12) {
            color: #ffd700 !important;
            background-color: #0a1f3d !important;
            font-size: 35px !important;
        }
        
        /* Coluna "Fim" em amarelo - Tarefas Atrasadas */
        #tela-tarefas table tbody tr td:nth-child(6) {
            color: #ffd700 !important;
            background-color: #0a1f3d !important;
            font-size: 35px !important;
        }
        
        /* N√∫meros em amarelo em Produtos em Produ√ß√£o */
        #tela-dashboard .card:last-child > div > div {
            color: #ffd700 !important;
        }
        
        /* Alinhar colunas de Obras */
        #tela-obras table { table-layout: fixed; width: 100%; }
        #tela-obras table th:nth-child(1),
        #tela-obras table td:nth-child(1) { width: 40px; }
        #tela-obras table th:nth-child(2),
        #tela-obras table td:nth-child(2) { width: 140px; }
        #tela-obras table th:nth-child(3),
        #tela-obras table td:nth-child(3) { width: 60px; }
        #tela-obras table th:nth-child(4),
        #tela-obras table td:nth-child(4) { width: 50px; }
        #tela-obras table th:nth-child(5),
        #tela-obras table td:nth-child(5) { width: 20px; }
        #tela-obras table th:nth-child(6),
        #tela-obras table td:nth-child(6) { width: 90px; }
        #tela-obras table th:nth-child(7),
        #tela-obras table td:nth-child(7) { width: 90px; }
        #tela-obras table th:nth-child(8),
        #tela-obras table td:nth-child(8) { width: 90px; }
        #tela-obras table th:nth-child(9),
        #tela-obras table td:nth-child(9) { width: 90px; }
        #tela-obras table th:nth-child(10),
        #tela-obras table td:nth-child(10) { width: 90px; }
        
        /* Status em OPs - coluna 8 */
        #tela-ops table th:nth-child(8),
        #tela-ops table td:nth-child(8) { width: 60px; }
        
        /* Status em Tarefas - coluna 3 */
        #tela-tarefas table th:nth-child(3),
        #tela-tarefas table td:nth-child(3) { width: 60px; }
        
        /* Produtos em Obras - coluna 8 */
        #tela-obras table tbody td:nth-child(8) {
            font-size: 18px !important;
            font-weight: normal !important;
        }
        
        /* Tarefa em Tarefas - coluna 1 */
        #tela-tarefas table th:nth-child(1),
        #tela-tarefas table td:nth-child(1) { width: 60px; font-size: 25px !important; }
        
        /* Reduzir fonte da coluna Tarefa para 25px */
        #tela-tarefas table tbody td:nth-child(1) {
            font-size: 25px !important;
        }
        
        /* Largura das colunas de Tarefas */
        #tela-tarefas table th:nth-child(1),
        #tela-tarefas table td:nth-child(1) { width: 100px; }
        
        #tela-tarefas table th:nth-child(2),
        #tela-tarefas table td:nth-child(2) { width: 80px; }
        
        #tela-tarefas table th:nth-child(3),
        #tela-tarefas table td:nth-child(3) { width: 100px; }
        
        #tela-tarefas table th:nth-child(4),
        #tela-tarefas table td:nth-child(4) { width: 100px; }
        
        #tela-tarefas table th:nth-child(5),
        #tela-tarefas table td:nth-child(5) { width: 70px; }
        
        #tela-tarefas table th:nth-child(6),
        #tela-tarefas table td:nth-child(6) { width: 80px; }
        
        #tela-tarefas table th:nth-child(7),
        #tela-tarefas table td:nth-child(7) { width: 80px; }
        
        /* Mostrar t√≠tulos de Status das Obras e Status das OPs */
        #tela-dashboard .card h3 {
            display: block !important;
            visibility: visible !important;
            margin: 0 !important;
            padding: 15px 20px !important;
            background: #0a1f3d !important;
            color: #ffffff !important;
            font-size: 18px !important;
            font-weight: bold !important;
            text-transform: uppercase !important;
            width: 100% !important;
            border-bottom: 2px solid #1a3f5d !important;
        }
        
        /* Mostrar cabe√ßalho de M√°quinas em Produ√ß√£o */
        #tela-dashboard .card:last-child h3 {
            display: block !important;
            visibility: visible !important;
            margin: 0 !important;
            padding: 15px 20px !important;
            background: #0a1f3d !important;
            color: #ffffff !important;
            font-size: 18px !important;
            font-weight: bold !important;
            text-transform: uppercase !important;
            width: 100% !important;
            border-bottom: 2px solid #1a3f5d !important;
        }
        
        #tela-tarefas table th:nth-child(8),
        #tela-tarefas table td:nth-child(8) { width: 60px; }
        
        #tela-tarefas table th:nth-child(9),
        #tela-tarefas table td:nth-child(9) { width: 150px; }
        
        /* Coluna In√≠cio de Montagem em branco - Obras (coluna 6) */
        #tela-obras table tbody tr td:nth-child(6) {
            color: #ffffff !important;
        }
        
        /* Coluna Fim de Montagem em amarelo - Obras (coluna 7) */
        #tela-obras table tbody tr td:nth-child(7) {
            color: #ffd700 !important;
        }
        
        /* Coluna In√≠cio de Montagem em branco - OPs (coluna 9) */
        #tela-ops table tbody tr td:nth-child(9) {
            color: #ffffff !important;
        }
        
        /* Coluna Fim de Montagem em amarelo - OPs (coluna 10) */
        #tela-ops table tbody tr td:nth-child(10) {
            color: #ffd700 !important;
        }
        
        /* Coluna In√≠cio de Montagem em branco - Tarefas (coluna 6) */
        #tela-tarefas table tbody tr td:nth-child(6) {
            color: #ffffff !important;
        }
        
        /* Coluna Fim de Montagem em amarelo - Tarefas (coluna 7) */
        #tela-tarefas table tbody tr td:nth-child(7) {
            color: #ffd700 !important;
        }
        
        /* Altura da linha In√≠cio/Fim em todas as tabelas */
        table thead tr:last-child th {
            height: 30px !important;
        }
        

        
        /* Altura do cabe√ßalho de Dashboard em apresenta√ß√£o */
        .apresentacao-container .apresentacao-header {
            min-height: 130px !important;
        }
        
        /* Altura das linhas de Status apenas na primeira p√°gina (Dashboard) */
        .apresentacao-container #tela-dashboard table tbody tr td {
            height: 50px !important;
            padding: 0px 0px 0px 0px !important;
            margin: 0px !important;
            line-height: 50px !important;
        }
        
        .tela {
            display: none;
        }
        
        .tela.ativo {
            display: block;
        }
        
        .indicador-pagina {
            text-align: center;
            margin-top: 10px;
            font-size: 12px;
            color: #666;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="apresentacao-container">
        <!-- Header -->
        <div class="apresentacao-header" style="position: relative; display: flex; align-items: center; justify-content: center;">
            <img src="data:image/png;base64,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" alt="NTC" style="height: 180px; width: 180px; position: absolute; left: 20px; top: 50%; transform: translateY(-50%);">
            <h1 style="margin: 0;">Produ√ß√£o NTC</h1>
        </div>
        
        <!-- Content -->
        <div class="apresentacao-content" id="content">
            <!-- TELA 1: DASHBOARD -->
            <div id="tela-dashboard" class="tela ativo">
                <div class="card">
                    <div class="kpi">
                        <div class="box">
                            <div>Obras</div>
                            <div class="n">{{ obras_total }}</div>
                        </div>
                        <div class="box">
                            <div>OPs</div>
                            <div class="n">{{ ops_total }}</div>
                        </div>
                        <div class="box">
                            <div>Tarefas</div>
                            <div class="n">{{ ap_total }}</div>
                        </div>
                    </div>
                </div>
                
                <div class="card">
                    <h3>Status das Obras</h3>
                    <div class="status-row">
                        <span class="badge badge-dashboard">üîµ Abertas: {{ obras_abertas }}</span>
                        <span class="badge badge-dashboard">üü° Em Execu√ß√£o: {{ obras_em_exec }}</span>
                        <span class="badge badge-dashboard">üü¢ Conclu√≠das: {{ obras_concluidas }}</span>
                        <span class="badge badge-dashboard">üî¥ Atrasadas: {{ obras_atrasadas }}</span>
                    </div>
                </div>
                
                <div class="card">
                    <h3>Status das OPs</h3>
                    <div class="status-row">
                        <span class="badge badge-dashboard">üîµ Abertas: {{ abertas }}</span>
                        <span class="badge badge-dashboard">üü° Em Execu√ß√£o: {{ em_exec }}</span>
                        <span class="badge badge-dashboard">üü¢ Conclu√≠das: {{ concluidas }}</span>
                        <span class="badge badge-dashboard">üî¥ Atrasadas: {{ atrasadas }}</span>
                    </div>
                </div>
                
                <div class="card">
                    <h3 style="margin: 0; padding: 15px 20px; background: #0a1f3d; color: #ffffff; font-size: 18px; font-weight: bold; text-transform: uppercase;">M√°quinas em Produ√ß√£o</h3>
                    <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 12px; padding: 12px;">
                        {% set produtos_list = (produtos_str or '').split(', ') %}
                        {% for produto in produtos_list %}
                            {% if produto.strip() %}
                            <div style="font-size: 40px; font-weight: bold; color: #ffd700; text-align: center; padding: 14px; background: #0a1f3d; border: 2px solid #1a3f5d; border-radius: 12px; box-shadow: 0 4px 8px rgba(0,0,0,0.15);">
                                {{ produto.strip() }}
                            </div>
                            {% endif %}
                        {% endfor %}
                    </div>
                </div>
            </div>
            
            <!-- TELA 2: OBRAS -->
            <div id="tela-obras" class="tela">
                <div class="card">

                    <table>
                        <thead>
                            <tr>
                                <th>C√≥digo</th>
                                <th>Nome</th>
                                <th>Cliente</th>
                                <th>Status</th>
                                <th>%</th>
                                <th colspan="2" style="text-align: center;">Montagem</th>
                                <th>Produtos</th>
                            </tr>
                            <tr>
                                <th colspan="5"></th>
                                <th style="font-size: 12px; padding: 4px; height: 30px;">In√≠cio</th>
                                <th style="font-size: 12px; padding: 4px; height: 30px;">Fim</th>
                                <th></th>
                            </tr>
                        </thead>
                        <tbody id="tbody-obras">
                            {% if obras %}
                                {% for obra in obras %}
                                <tr>
                                    <td><strong>{{ obra.codigo }}</strong></td>
                                    <td>{{ obra.nome }}</td>
                                    <td>{{ obra.cliente }}</td>
                                    <td><span class="badge" style="padding: 4px 8px; font-size: 16px;">{{ obra.status }}</span></td>
                                    <td>{{ obra.percentual }}%</td>
                                    <td style="background: #ecf8fb;">{{ obra.montagem_eletro_inicio }}</td>
                                    <td style="background: #ecf8fb;">{{ obra.montagem_eletro_fim }}</td>
                                    <td>{{ obra.produtos }}</td>
                                </tr>
                                {% endfor %}
                            {% else %}
                                <tr>
                                    <td colspan="10" style="text-align: center; color: #999;">Nenhuma obra encontrada</td>
                                </tr>
                            {% endif %}
                        </tbody>
                    </table>
                    <div class="indicador-pagina" id="indicador-obras"></div>
                </div>
            </div>
            
            <!-- TELA 3: OPS -->
            <div id="tela-ops" class="tela">
                <div class="card">

                    <table>
                        <thead>
                            <tr>
                                <th>OP</th>
                                <th>Obra</th>
                                <th>Cliente</th>
                                <th>Nome Obra</th>
                                <th>Produto</th>
                                <th>Qtd</th>
                                <th style="background: #fffbf0; color: #d97706;">%</th>
                                <th>Status</th>
                                <th colspan="2" style="text-align: center;">Montagem</th>
                            </tr>
                            <tr>
                                <th colspan="8"></th>
                                <th style="font-size: 12px; padding: 4px; height: 30px;">In√≠cio</th>
                                <th style="font-size: 12px; padding: 4px; height: 30px;">Fim</th>
                            </tr>
                        </thead>
                        <tbody id="tbody-ops">
                            {% if ops %}
                                {% for op in ops %}
                                <tr>
                                    <td><strong>{{ op.numero }}</strong></td>
                                    <td>{{ op.obra_codigo }}</td>
                                    <td>{{ op.cliente }}</td>
                                    <td>{{ op.obra_nome }}</td>
                                    <td>{{ op.produto }}</td>
                                    <td>{{ op.quantidade }}</td>
                                    <td>{{ op.percentual }}%</td>
                                    <td><span class="badge" style="padding: 4px 8px; font-size: 16px;">{{ op.status }}</span></td>
                                    <td style="background: #ecf8fb;">{{ op.montagem_eletro_inicio }}</td>
                                    <td style="background: #ecf8fb;">{{ op.montagem_eletro_fim }}</td>
                                </tr>
                                {% endfor %}
                            {% else %}
                                <tr>
                                    <td colspan="12" style="text-align: center; color: #999;">Nenhuma OP encontrada</td>
                                </tr>
                            {% endif %}
                        </tbody>
                    </table>
                    <div class="indicador-pagina" id="indicador-ops"></div>
                </div>
            </div>
            
            <!-- TELA 4: TAREFAS ATRASADAS -->
            <div id="tela-tarefas" class="tela">
                <div class="card">
                    <h3>Produ√ß√£o NTC ‚Äî Tarefas Atrasadas</h3>
                    <table>
                        <thead>
                            <tr>
                                <th>Tarefa</th>
                                <th>Obra</th>
                                <th>Produto</th>
                                <th>Respons√°vel</th>
                                <th>Status</th>
                                <th colspan="2" style="text-align: center;">Montagem</th>
                                <th>Horas</th>
                                <th>Justificativa</th>
                            </tr>
                            <tr>
                                <th colspan="5"></th>
                                <th style="font-size: 12px; padding: 4px; height: 30px;">In√≠cio</th>
                                <th style="font-size: 12px; padding: 4px; height: 30px;">Fim</th>
                                <th colspan="2"></th>
                            </tr>
                        </thead>
                        <tbody id="tbody-tarefas">
                            {% if tarefas %}
                                {% for tarefa in tarefas %}
                                <tr>
                                    <td><strong>{{ tarefa.titulo }}</strong></td>
                                    <td>{{ tarefa.obra_nome }}</td>
                                    <td>{{ tarefa.produto }}</td>
                                    <td>{{ tarefa.responsavel_nome }}</td>
                                    <td><span class="badge" style="padding: 4px 8px; font-size: 16px;">{{ tarefa.status }}</span></td>
                                    <td style="background: #ecf8fb;">{{ tarefa.montagem_eletro_inicio }}</td>
                                    <td style="background: #ecf8fb;">{{ tarefa.montagem_eletro_fim }}</td>
                                    <td style="text-align: center; font-weight: bold;">{{ tarefa.horas_previstas }}h</td>
                                    <td>{{ tarefa.justificativa_pausa }}</td>
                                </tr>
                                {% endfor %}
                            {% else %}
                                <tr>
                                    <td colspan="9" style="text-align: center; color: #999;">Nenhuma tarefa atrasada encontrada</td>
                                </tr>
                            {% endif %}
                        </tbody>
                    </table>
                    <div class="indicador-pagina" id="indicador-tarefas"></div>
                </div>
            </div>
        </div>
        
        <!-- Footer -->
        <div class="apresentacao-footer">
            <span>üè≠ Produ√ß√£o NTC</span>
            <span id="hora"></span>
        </div>
    </div>
    
    <!-- Contador -->
    <div class="contador" id="contador">6s</div>
    
    <script>
        const INTERVALO = 6000;
        let sequencia = [];
        let telaAtualIdx = 0;
        let contadorTempo = 6;
        
        // Dados de pagina√ß√£o
        let paginaObras = 0;
        let paginaOps = 0;
        let paginaTarefas = 0;
        const LINHAS_POR_PAGINA = 10;
        
        // Construir sequ√™ncia de telas
        function construirSequencia() {
            sequencia = ['tela-dashboard'];
            
            // Contar p√°ginas de obras
            const tbodyObras = document.getElementById('tbody-obras');
            const linhasObras = tbodyObras ? tbodyObras.querySelectorAll('tr').length : 0;
            const paginasObras = Math.ceil(linhasObras / LINHAS_POR_PAGINA);
            
            for (let i = 0; i < paginasObras; i++) {
                sequencia.push('tela-obras');
            }
            
            // Contar p√°ginas de OPs
            const tbodyOps = document.getElementById('tbody-ops');
            const linhasOps = tbodyOps ? tbodyOps.querySelectorAll('tr').length : 0;
            const paginasOps = Math.ceil(linhasOps / LINHAS_POR_PAGINA);
            
            for (let i = 0; i < paginasOps; i++) {
                sequencia.push('tela-ops');
            }
            
            // Contar p√°ginas de tarefas
            const tbodyTarefas = document.getElementById('tbody-tarefas');
            const linhasTarefas = tbodyTarefas ? tbodyTarefas.querySelectorAll('tr').length : 0;
            const paginasTarefas = Math.ceil(linhasTarefas / LINHAS_POR_PAGINA);
            
            for (let i = 0; i < paginasTarefas; i++) {
                sequencia.push('tela-tarefas');
            }
        }
        
        // Atualizar hora
        function atualizarHora() {
            const agora = new Date();
            const hora = agora.toLocaleTimeString('pt-BR', { 
                hour: '2-digit', 
                minute: '2-digit', 
                second: '2-digit' 
            });
            document.getElementById('hora').textContent = hora;
        }
        
        // Paginar tabelas
        function paginarTabela(tbody) {
            const linhas = tbody.querySelectorAll('tr');
            const totalLinhas = linhas.length;
            const totalPaginas = Math.ceil(totalLinhas / LINHAS_POR_PAGINA);
            
            linhas.forEach((linha) => {
                linha.style.display = 'none';
            });
            
            let paginaAtual = 0;
            if (tbody.id === 'tbody-obras') {
                paginaAtual = paginaObras % totalPaginas;
            } else if (tbody.id === 'tbody-ops') {
                paginaAtual = paginaOps % totalPaginas;
            } else if (tbody.id === 'tbody-tarefas') {
                paginaAtual = paginaTarefas % totalPaginas;
            }
            
            const inicio = paginaAtual * LINHAS_POR_PAGINA;
            const fim = inicio + LINHAS_POR_PAGINA;
            
            for (let i = inicio; i < fim && i < totalLinhas; i++) {
                linhas[i].style.display = 'table-row';
            }
            
            return { paginaAtual: paginaAtual + 1, totalPaginas };
        }
        
        // Mudar tela
        function mudarTela() {
            const telaId = sequencia[telaAtualIdx];
            const headerH1 = document.querySelector('.apresentacao-header h1');
            
            ['tela-dashboard', 'tela-obras', 'tela-tarefas', 'tela-ops'].forEach(tela => {
                const el = document.getElementById(tela);
                if (el) el.classList.remove('ativo');
            });
            if (document.getElementById(telaId)) {
                document.getElementById(telaId).classList.add('ativo');
            }
            
            // Atualizar cabe√ßalho conforme a tela
            if (telaId === 'tela-dashboard') {
                headerH1.textContent = 'Produ√ß√£o NTC';
            } else if (telaId === 'tela-obras') {
                headerH1.textContent = 'Produ√ß√£o NTC ‚Äî Obras';
            } else if (telaId === 'tela-ops') {
                headerH1.textContent = 'Produ√ß√£o NTC ‚Äî Ordens de Produ√ß√£o';
            } else if (telaId === 'tela-tarefas') {
                headerH1.textContent = 'Produ√ß√£o NTC ‚Äî Tarefas Atrasadas';
            }
            
            if (telaId === 'tela-obras') {
                const tbody = document.getElementById('tbody-obras');
                if (tbody) {
                    const { paginaAtual, totalPaginas } = paginarTabela(tbody);
                    document.getElementById('indicador-obras').textContent = 'Pagina ' + paginaAtual + ' de ' + totalPaginas;
                }
                paginaObras++;
            } else if (telaId === 'tela-ops') {
                const tbody = document.getElementById('tbody-ops');
                if (tbody) {
                    const { paginaAtual, totalPaginas } = paginarTabela(tbody);
                    document.getElementById('indicador-ops').textContent = 'Pagina ' + paginaAtual + ' de ' + totalPaginas;
                }
                paginaOps++;
            } else if (telaId === 'tela-tarefas') {
                const tbody = document.getElementById('tbody-tarefas');
                if (tbody) {
                    const { paginaAtual, totalPaginas } = paginarTabela(tbody);
                    document.getElementById('indicador-tarefas').textContent = 'Pagina ' + paginaAtual + ' de ' + totalPaginas;
                    
                    // Se √© a √∫ltima p√°gina de tarefas, recarregar ap√≥s 6 segundos
                    if (paginaAtual === totalPaginas && totalPaginas > 0) {
                        setTimeout(function() {
                            location.reload();
                        }, INTERVALO);
                    }
                }
                paginaTarefas++;
            }
            
            contadorTempo = 6;
            document.getElementById('contador').textContent = contadorTempo + 's';
            telaAtualIdx = (telaAtualIdx + 1) % sequencia.length;
        }
        
        function atualizarContador() {
            contadorTempo--;
            document.getElementById('contador').textContent = contadorTempo + 's';
        }
        
        // Recarregar dados da API a cada 3 segundos
        function recarregarDados() {
            fetch('/api/apresentacao')
                .then(response => response.json())
                .then(data => {
                    // Atualizar dashboard
                    document.getElementById('total-obras').textContent = data.dashboard.total_obras;
                    document.getElementById('total-ops').textContent = data.dashboard.total_ops;
                    document.getElementById('total-tarefas').textContent = data.dashboard.tarefas_concluidas + data.dashboard.tarefas_em_execucao + data.dashboard.tarefas_planejadas;
                    
                    // Atualizar obras
                    const tbodyObras = document.getElementById('tbody-obras');
                    if (tbodyObras && data.obras_pagina1 && data.obras_pagina2) {
                        const obras = [...data.obras_pagina1, ...data.obras_pagina2];
                        tbodyObras.innerHTML = obras.map(obra => `
                            <tr>
                                <td>${obra.codigo}</td>
                                <td>${obra.nome}</td>
                                <td>${obra.cliente}</td>
                                <td>${obra.status}</td>
                                <td>${obra.percentual}%</td>
                            </tr>
                        `).join('');
                    }
                    
                    // Atualizar OPs
                    const tbodyOps = document.getElementById('tbody-ops');
                    if (tbodyOps && data.ops_pagina1 && data.ops_pagina2) {
                        const ops = [...data.ops_pagina1, ...data.ops_pagina2];
                        tbodyOps.innerHTML = ops.map(op => `
                            <tr>
                                <td>${op.numero}</td>
                                <td>${op.obra_nome}</td>
                                <td>${op.cliente}</td>
                                <td>${op.produto}</td>
                                <td>${op.quantidade}</td>
                                <td>${op.percentual}%</td>
                                <td>${op.status}</td>
                            </tr>
                        `).join('');
                    }
                    
                    // Atualizar tarefas atrasadas
                    const tbodyTarefas = document.getElementById('tbody-tarefas');
                    if (tbodyTarefas && data.tarefas) {
                        tbodyTarefas.innerHTML = data.tarefas.map(tarefa => `
                            <tr>
                                <td>${tarefa.titulo}</td>
                                <td>${tarefa.obra_nome}</td>
                                <td>${tarefa.produto}</td>
                                <td>${tarefa.responsavel_nome}</td>
                                <td>${tarefa.data_inicio_prev}</td>
                                <td>${tarefa.data_fim_prev}</td>
                                <td>${tarefa.horas_previstas}h</td>
                                <td><span class="badge" style="background-color: #f44336; color: white;">${tarefa.status}</span></td>
                                <td>${tarefa.justificativa_pausa}</td>
                            </tr>
                        `).join('');
                    }
                    
                    // Reconstruir sequ√™ncia com novos dados
                    construirSequencia();
                })
                .catch(error => console.error('Erro ao recarregar dados:', error));
        }
        
        window.addEventListener('load', function() {
            construirSequencia();
            atualizarHora();
            setInterval(atualizarHora, 1000);
            setInterval(atualizarContador, 1000);
            setInterval(mudarTela, INTERVALO);
        });
    </script>
</body>
</html>
        
        /* Igualar largura de colunas Obras com OPs */
        #tela-obras table th:nth-child(1),
        #tela-obras table td:nth-child(1),
        #tela-ops table th:nth-child(1),
        #tela-ops table td:nth-child(1) { width: 60px; }
